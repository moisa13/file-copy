services:
  file-copy-manager:
    build: .
    container_name: file-copy-manager
    ports:
      - "3020:3020"
    volumes:
      - fcm-data:/app/data
      - fcm-logs:/app/logs
      - /mnt/storage:/mnt/storage
    environment:
      - PORT=3020
      - HOST=0.0.0.0
      - WORKER_DEFAULT_COUNT=4
      - WORKER_MAX_COUNT=16
      - LOG_DIR=/app/logs
      - LOG_MAX_SIZE=10M
      - LOG_MAX_FILES=50
      - DB_PATH=/app/data/queue.db
      - HASH_ALGORITHM=sha256
      - SCANNER_RECURSIVE=true
      - RATE_LIMIT_WINDOW_MS=60000
      - RATE_LIMIT_MAX=200
      - REQUEST_LOG_FORMAT=short
    restart: unless-stopped

volumes:
  fcm-data:
  fcm-logs:
